!function(){function e(){this.posFrom=this.posTo=this.query=null,this.marked=[]}function o(o){return o._searchState||(o._searchState=new e)}function n(e,o,n){return e.getSearchCursor(o,n,"string"==typeof o&&o==o.toLowerCase())}function r(e,o,n,r){e.openDialog?e.openDialog(o,r):r(prompt(n,""))}function t(e,o,n,r){e.openConfirm?e.openConfirm(o,r):confirm(n)&&r[0]()}function i(e){var o=e.match(/^\/(.*)\/([a-z]*)$/);return o?new RegExp(o[1],-1==o[2].indexOf("i")?"":"i"):e}function c(e,t){var c=o(e);return c.query?a(e,t):void r(e,p,"Search for:",function(o){e.operation(function(){if(o&&!c.query){if(c.query=i(o),e.lineCount()<2e3)for(var r=n(e,c.query);r.findNext();)c.marked.push(e.markText(r.from(),r.to(),"CodeMirror-searching"));c.posFrom=c.posTo=e.getCursor(),a(e,t)}})})}function a(e,r){e.operation(function(){var t=o(e),i=n(e,t.query,r?t.posFrom:t.posTo);(i.find(r)||(i=n(e,t.query,r?{line:e.lineCount()-1}:{line:0,ch:0}),i.find(r)))&&(e.setSelection(i.from(),i.to()),t.posFrom=i.from(),t.posTo=i.to())})}function f(e){e.operation(function(){var n=o(e);if(n.query){n.query=null;for(var r=0;r<n.marked.length;++r)n.marked[r].clear();n.marked.length=0}})}function u(e,o){r(e,s,"Replace:",function(c){c&&(c=i(c),r(e,l,"Replace with:",function(r){function i(){var o,r=u.from();!(o=u.findNext())&&(u=n(e,c),!(o=u.findNext())||r&&u.from().line==r.line&&u.from().ch==r.ch)||(e.setSelection(u.from(),u.to()),t(e,m,"Replace?",[function(){a(o)},i]))}function a(e){u.replace("string"==typeof c?r:r.replace(/\$(\d)/,function(o,n){return e[n]})),i()}if(o)e.compoundChange(function(){e.operation(function(){for(var o=n(e,c);o.findNext();)if("string"!=typeof c){var t=e.getRange(o.from(),o.to()).match(c);o.replace(r.replace(/\$(\d)/,function(e,o){return t[o]}))}else o.replace(r)})});else{f(e);var u=n(e,c,e.getCursor());i()}}))})}var p='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',s='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',l='With: <input type="text" style="width: 10em"/>',m="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(e){f(e),c(e)},CodeMirror.commands.findNext=c,CodeMirror.commands.findPrev=function(e){c(e,!0)},CodeMirror.commands.clearSearch=f,CodeMirror.commands.replace=u,CodeMirror.commands.replaceAll=function(e){u(e,!0)}}();