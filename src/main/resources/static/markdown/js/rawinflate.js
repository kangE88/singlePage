/*
 * $Id: rawinflate.js,v 0.2 2009/03/01 18:32:24 dankogai Exp $
 *
 * original:
 * http://www.onicos.com/staff/iz/amuse/javascript/expert/inflate.txt
 */
!function(){var r,t,n,e,i,f,o,u,s,l,a,h,w,A,b,c,d=32768,y=0,v=9,m=6,g=null,B=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535),M=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0),X=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99),_=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577),x=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),k=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),p=function(){this.next=null,this.list=null},z=function(){this.e=0,this.b=0,this.n=0,this.t=null},C=function(r,t,n,e,i,f){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var o,u,s,l,a,h,w,A,b,c,d,y,v,m,g,B,M,X=new Array(this.BMAX+1),_=new Array(this.BMAX+1),x=new z,k=new Array(this.BMAX),C=new Array(this.N_MAX),D=new Array(this.BMAX+1);for(M=this.root=null,h=0;h<X.length;h++)X[h]=0;for(h=0;h<_.length;h++)_[h]=0;for(h=0;h<k.length;h++)k[h]=null;for(h=0;h<C.length;h++)C[h]=0;for(h=0;h<D.length;h++)D[h]=0;u=t>256?r[256]:this.BMAX,b=r,c=0,h=t;do X[b[c]]++,c++;while(--h>0);if(X[0]==t)return this.root=null,this.m=0,void(this.status=0);for(w=1;w<=this.BMAX&&0==X[w];w++);for(A=w,w>f&&(f=w),h=this.BMAX;0!=h&&0==X[h];h--);for(l=h,f>h&&(f=h),m=1<<w;h>w;w++,m<<=1)if((m-=X[w])<0)return this.status=2,void(this.m=f);if((m-=X[h])<0)return this.status=2,void(this.m=f);for(X[h]+=m,D[1]=w=0,b=X,c=1,v=2;--h>0;)D[v++]=w+=b[c++];b=r,c=0,h=0;do 0!=(w=b[c++])&&(C[D[w]++]=h);while(++h<t);for(t=D[l],D[0]=h=0,b=C,c=0,a=-1,y=_[0]=0,d=null,g=0;l>=A;A++)for(o=X[A];o-->0;){for(;A>y+_[1+a];){if(y+=_[1+a],a++,g=(g=l-y)>f?f:g,(s=1<<(w=A-y))>o+1)for(s-=o+1,v=A;++w<g&&!((s<<=1)<=X[++v]);)s-=X[v];for(y+w>u&&u>y&&(w=u-y),g=1<<w,_[1+a]=w,d=new Array(g),B=0;g>B;B++)d[B]=new z;M=null==M?this.root=new p:M.next=new p,M.next=null,M.list=d,k[a]=d,a>0&&(D[a]=h,x.b=_[a],x.e=16+w,x.t=d,w=(h&(1<<y)-1)>>y-_[a],k[a-1][w].e=x.e,k[a-1][w].b=x.b,k[a-1][w].n=x.n,k[a-1][w].t=x.t)}for(x.b=A-y,c>=t?x.e=99:b[c]<n?(x.e=b[c]<256?16:15,x.n=b[c++]):(x.e=i[b[c]-n],x.n=e[b[c++]-n]),s=1<<A-y,w=h>>y;g>w;w+=s)d[w].e=x.e,d[w].b=x.b,d[w].n=x.n,d[w].t=x.t;for(w=1<<A-1;0!=(h&w);w>>=1)h^=w;for(h^=w;(h&(1<<y)-1)!=D[a];)y-=_[a],a--}this.m=_[1],this.status=0!=m&&1!=l?1:0},D=function(){return b.length==c?-1:255&b.charCodeAt(c++)},R=function(r){for(;r>f;)i|=D()<<f,f+=8},j=function(r){return i&B[r]},H=function(r){i>>=r,f-=r},N=function(n,e,i){var f,u,b;if(0==i)return 0;for(b=0;;){for(R(w),u=a.list[j(w)],f=u.e;f>16;){if(99==f)return-1;H(u.b),f-=16,R(f),u=u.t[j(f)],f=u.e}if(H(u.b),16!=f){if(15==f)break;for(R(f),s=u.n+j(f),H(f),R(A),u=h.list[j(A)],f=u.e;f>16;){if(99==f)return-1;H(u.b),f-=16,R(f),u=u.t[j(f)],f=u.e}for(H(u.b),R(f),l=t-u.n-j(f),H(f);s>0&&i>b;)s--,l&=d-1,t&=d-1,n[e+b++]=r[t++]=r[l++];if(b==i)return i}else if(t&=d-1,n[e+b++]=r[t++]=u.n,b==i)return i}return o=-1,b},S=function(n,e,u){var l;if(l=7&f,H(l),R(16),l=j(16),H(16),R(16),l!=(65535&~i))return-1;for(H(16),s=l,l=0;s>0&&u>l;)s--,t&=d-1,R(8),n[e+l++]=r[t++]=j(8),H(8);return 0==s&&(o=-1),l},q=function(r,t,i){if(null==g){var f,o,u=new Array(288);for(f=0;144>f;f++)u[f]=8;for(;256>f;f++)u[f]=9;for(;280>f;f++)u[f]=7;for(;288>f;f++)u[f]=8;if(e=7,o=new C(u,288,257,M,X,e),0!=o.status)return alert("HufBuild error: "+o.status),-1;for(g=o.root,e=o.m,f=0;30>f;f++)u[f]=5;if(zip_fixed_bd=5,o=new C(u,30,0,_,x,zip_fixed_bd),o.status>1)return g=null,alert("HufBuild error: "+o.status),-1;n=o.root,zip_fixed_bd=o.m}return a=g,h=n,w=e,A=zip_fixed_bd,N(r,t,i)},E=function(r,t,n){var e,i,f,o,u,s,l,b,c,d=new Array(316);for(e=0;e<d.length;e++)d[e]=0;if(R(5),l=257+j(5),H(5),R(5),b=1+j(5),H(5),R(4),s=4+j(4),H(4),l>286||b>30)return-1;for(i=0;s>i;i++)R(3),d[k[i]]=j(3),H(3);for(;19>i;i++)d[k[i]]=0;if(w=7,c=new C(d,19,19,null,null,w),0!=c.status)return-1;for(a=c.root,w=c.m,o=l+b,e=f=0;o>e;)if(R(w),u=a.list[j(w)],i=u.b,H(i),i=u.n,16>i)d[e++]=f=i;else if(16==i){if(R(2),i=3+j(2),H(2),e+i>o)return-1;for(;i-->0;)d[e++]=f}else if(17==i){if(R(3),i=3+j(3),H(3),e+i>o)return-1;for(;i-->0;)d[e++]=0;f=0}else{if(R(7),i=11+j(7),H(7),e+i>o)return-1;for(;i-->0;)d[e++]=0;f=0}if(w=v,c=new C(d,l,257,M,X,w),0==w&&(c.status=1),0!=c.status)return 1==c.status,-1;for(a=c.root,w=c.m,e=0;b>e;e++)d[e]=d[e+l];return A=m,c=new C(d,b,0,_,x,A),h=c.root,A=c.m,0==A&&l>257?-1:(1==c.status,0!=c.status?-1:N(r,t,n))},F=function(){null==r&&(r=new Array(2*d)),t=0,i=0,f=0,o=-1,u=!1,s=l=0,a=null},G=function(n,e,i){var f,h;for(f=0;i>f;){if(u&&-1==o)return f;if(s>0){if(o!=y)for(;s>0&&i>f;)s--,l&=d-1,t&=d-1,n[e+f++]=r[t++]=r[l++];else{for(;s>0&&i>f;)s--,t&=d-1,R(8),n[e+f++]=r[t++]=j(8),H(8);0==s&&(o=-1)}if(f==i)return f}if(-1==o){if(u)break;R(1),0!=j(1)&&(u=!0),H(1),R(2),o=j(2),H(2),a=null,s=0}switch(o){case 0:h=S(n,e+f,i-f);break;case 1:h=null!=a?N(n,e+f,i-f):q(n,e+f,i-f);break;case 2:h=null!=a?N(n,e+f,i-f):E(n,e+f,i-f);break;default:h=-1}if(-1==h)return u?0:-1;f+=h}return f},I=function(r){var t,n;F(),b=r,c=0;for(var e=new Array(1024),i=[];(t=G(e,0,e.length))>0;){var f=new Array(t);for(n=0;t>n;n++)f[n]=String.fromCharCode(e[n]);i[i.length]=f.join("")}return b=null,i.join("")};window.RawDeflate||(RawDeflate={}),RawDeflate.inflate=I}();